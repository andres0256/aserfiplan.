<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Chatbot Aserfiplan</title>
  <link rel="icon" href="LOGO.PNG" type="image/png">
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      padding: 20px;
    }
    #chatbox {
      width: 100%;
      max-width: 500px;
      margin: auto;
      background: #fff;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .message {
      margin: 10px 0;
    }
    .bot {
      color: #333;
    }
    .user {
      text-align: right;
      color: #007BFF;
    }
    input[type="text"] {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
      border-radius: 4px;
      border: 1px solid #ccc;
    }
    .contact-buttons {
      margin-top: 20px;
      display: flex;
      justify-content: center;
    }
    .contact-buttons a {
      text-decoration: none;
      padding: 10px 15px;
      border-radius: 5px;
      color: white;
      font-weight: bold;
      background-color: #25D366;
    }
  </style>
</head>
<body>
  <div id="chatbox">
    <div class="message bot" id="botMessage">
      <img src="logo.png.jpg" alt="Logo Aserfiplan" style="width: 40px; height: 40px; border-radius: 50%; margin-bottom: 10px;">
      <br>
      Gracias por comunicarte con <strong>Aserfiplan</strong>.<br><br>
      Ofrecemos asesoría especializada en:<br>
      1️⃣ Compra  y venta de inmuebles residenciales y comerciales<br>
      2️⃣ Seguros de vida, generales, accidentes y viajes al exterior<br>
      3️⃣ Organización financiera: mejora de tasas, créditos de vivienda, libre inversión y libranzas<br>
      4️⃣ Otra solicitud<br><br>
      Responde con el número de la opción y uno de nuestros asesores te contactará pronto.<br>
      <strong>Tu bienestar patrimonial es nuestra prioridad.</strong>
    </div>

    <div id="chatLog"></div>
    <input type="text" id="userInput" placeholder="Escribe el número de tu opción..." onkeypress="handleKey(event)">
    
    <div class="contact-buttons">
      <a class="whatsapp" id="whatsappLink" href="https://wa.me/573013422266?text=Hola%20Aserfiplan,%20quiero%20asesoría%20sobre%20..." target="_blank">Contactar por WhatsApp</a>
    </div>
  </div>

  <script>
    function handleKey(e) {
      if (e.key === 'Enter') {
        const input = document.getElementById('userInput');
        const value = input.value.trim();
        if (value) {
          const chatLog = document.getElementById('chatLog');
          chatLog.innerHTML += `<div class="message user">${value}</div>`;
          input.value = '';

          let response = '';
          let mensaje = '';
          switch (value) {
            case '1':
              response = 'Perfecto. Un asesor te contactará para ayudarte con la compra de inmuebles.';
              mensaje = 'Hola Aserfiplan, quiero asesoría sobre compra de inmuebles.';
              break;
            case '2':
              response = 'Genial. Te conectaremos con un experto en seguros.';
              mensaje = 'Hola Aserfiplan, quiero asesoría sobre seguros.';
              break;
            case '3':
              response = 'Excelente. Te ayudaremos a organizar tus finanzas.';
              mensaje = 'Hola Aserfiplan, quiero asesoría sobre organización financiera.';
              break;
            case '4':
              response = 'Gracias. Un asesor revisará tu solicitud personalizada.';
              mensaje = 'Hola Aserfiplan, tengo una solicitud personalizada.';
              break;
            default:
              response = 'Por favor, ingresa un número válido del 1 al 4.';
              mensaje = 'Hola Aserfiplan, tengo una duda sobre sus servicios.';
          }

          chatLog.innerHTML += `<div class="message bot">${response}</div>`;

          const mensajeCodificado = encodeURIComponent(mensaje);
          document.getElementById('whatsappLink').href = `https://wa.me/573013422266?text=${mensajeCodificado}`;

          // Enviar datos al backend para generar PDF y enviarlo por correo
          fetch('https://TU_BACKEND.com/api/generar-pdf', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              cliente: 'Usuario del chatbot',
              mensaje: mensaje,
              respuesta: response
            })
          })
          .then(res => res.json())
          .then(data => console.log('PDF generado y enviado al correo:', data))
          .catch(err => console.error('Error al generar PDF:', err));
        }
      }
    }
  </script>
</body>
</html>
